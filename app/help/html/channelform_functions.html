<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>ChannelForm functions</title>
<meta name="generator" content="MATLAB 24.2">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2025-08-24">
<meta name="DC.source" content="channelform_functions.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h1>ChannelForm functions</h1>
<!--introduction-->
<p>Summary of functions available in the <i>cf_functions</i> folder. Use the Matlab&trade; help function in the command window to get further details of each function.</p>
<!--/introduction-->
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">Model functions</a>
</li>
<li>
<a href="#3">Grid Functions</a>
</li>
<li>
<a href="#4">Core grid functions</a>
</li>
<li>
<a href="#5">Additional utility functions</a>
</li>
<li>
<a href="#6">Functions from Matlab&trade; Exchange Forum</a>
</li>
<li>
<a href="#9">Generic functions</a>
</li>
<li>
<a href="#11">See Also</a>
</li>
</ul>
</div>
<h2 id="1">Model functions</h2>
<p>Functions that implement various form models</p>
<div>
<ul>
<li>
<b>cf_changeplot</b> - plot volume difference over the model run and the variation of sediment exchange with transgression distance.</li>
<li>
<b>cf_cst2grid</b> - interpolate the CST water levels onto the model grid.</li>
<li>
<b>cf_exp_models</b> - construct idealised channel form using exponential functions in y to determine width and CKFA cross-section to determine z at each x interval.</li>
<li>
<b>cf_model_tabs</b> - generate tabPlot and tabProperties for any GDinterface model.</li>
<li>
<b>cf_offset_wls</b> - translate water levels landwards when mouth is some distance from x=0 and pad the water level vectors with values at the mouth.</li>
<li>
<b>cf_pow_model</b> - function to compute 3D form of a creek or tidal channel using power laws to define width and hydraulic depth variations.</li>
<li>
<b>cf_sectionplot</b> - plot a set of along-channel cross-sections and the channel centre-line (thalweg) for the initial and final grid.</li>
<li>
<b>cf_set_hydroprops</b> - set water levels for form model using either the surface defined by the cst_model or high water at the mouth and a reducing tidal amplitude.</li>
<li>
<b>cf_summarygridplot</b> - plot initial grid, new grid and difference.</li>
<li>
<b>cf_summarytransplot</b> - composite set of plots to show results form Transgression table.</li>
<li>
<b>cf_valley_model</b> - construct idealised channel form using 3D exponential form model.</li>
<li>
<b>cf_writetable</b> - write GrossProps and Transgression output tables to a file.</li>
<li>
<b>ckfa_3D_form</b> - construct 3D form of an idealised channel based on the CKFA model.</li>
<li>
<b>ckfa_dimensions</b> - utility to get the CKFA channel form properties: hydraulic depth, hm, width convergence length, Lw, critical tidal velocity amplitude, Ucr.</li>
<li>
<b>ckfa_form_model</b> - construct idealised channel form using 3D CKFA model</li>
<li>
<b>ckfa_form_solver</b> - find the hydraulic depth, e-folding length for width and the peak tidal amplitude for defined tidal range and sediment properties.</li>
<li>
<b>ckfa_wave_form</b> - obtain depth and width of wave formed profile at high and low water</li>
<li>
<b>ckfa_wave_profile</b> - depth and width of wave formed profile d=dw*(1-y/yw)^2/3.</li>
<li>
<b>get_river_profile</b> - get river profile using regime theoretical profile (Cao &amp; Knight,1996).</li>
<li>
<b>get_river_regime</b> - get river regime properties using regime theoretical profile (Cao &amp; Knight,1996).</li>
</ul>
</div>
<h2 id="3">Grid Functions</h2>
<p>Functions used to manipulate cartesian grids can be found in the <i>muiAppGridFcns</i> folder and include the following:</p>
<h2 id="4">Core grid functions</h2>
<div>
<ul>
<li>
<b>gd_ax_dir</b> - check direction of grid axes and reverse if descending, OR find grid orientation using ishead and direction of x-axis, OR check a grid axis direction by prompting user.</li>
<li>
<b>gd_centreline.m</b> - create a centreline of a channel using function <i>a_star</i> to trace the shortest path between start and end points whilst finding the deepest points (i.e. a thalweg).</li>
<li>
<b>gd_colormap</b> - check if Mapping toolbox is installed to use land/sea colormap, or call <i>cmap_selection</i> if not available (see <a href="matlab:doc('psfunctions')">Plotting and statistical functions</a> in the <a href="matlab:doc('muitoolbox')">muitoolbox</a>).</li>
<li>
<b>gd_convergencelength</b> - least squares fit using fminsearch to % find the convergence length of a channel from a distance-width xy data set.</li>
<li>
<b>gd_digitisepoints</b> - creates figure to interactively digitise points on a grid and add elevations if required.</li>
<li>
<b>gd_dimensions</b> - get the grid dimsnions for a grid struct (as used in GDinterface).</li>
<li>
<b>gd_getpoint.m</b> - interactively select a point on a plot and return the point coordinates.</li>
<li>
<b>gd_grid_line</b> - create a grid from scattered data points input as xyz tuples.</li>
<li>
<b>gd_plotgrid</b> - create pcolor plot of gridded surface.</li>
<li>
<b>gd_plotsections</b> - display grid and allow user to interactively define start and end points of a section line to be plotted in a figure.</li>
<li>
<b>gd_pnt2vec.m</b> - convert an array of structs with x,y (and z) fields to a [Nx2] or [Nx3] array of points, or a single stuct with vectors for the x, y (and z) fields.</li>
<li>
<b>gd_read_image.m</b> - read cdata for an image from an ASCII text file, with the positional information.</li>
<li>
<b>gd_readshapefile.m</b> - read the x and y coordinates from a shape file. Lines are concatenated and separated by NaNs in single x and y vectors. Suitable for reading boundaries or sections into a single array.</li>
<li>
<b>gd_selectpoints</b> - accept figure to interactively create a specified number of x,y points on a grid.</li>
<li>
<b>gd_setpoint</b> - interactively select a single point on a plot and return the point coordinates. Includes an option to enter an additional value at the selected point (e.g. for elevation).</li>
<li>
<b>gd_setpoints.m</b> - interactively create a set of points on a plot and return the point coordinates. Includes an option to enter an additional value at the selected points (e.g. elevation).</li>
<li>
<b>gd_startendpoints</b> - accept figure to interactively select start and end points on a grid.</li>
<li>
<b>gd_subdomain</b> - accept figure to interactively select a subdomain of a grid.</li>
<li>
<b>gd_subgrid</b> - extract a subdomain from a grid and return the extracted grid and the source grid indices of the bounding rectangle.</li>
<li>
<b>gd_write_image.m</b> - write image to a jpg or tif file.</li>
<li>
<b>gd_write_image_ascii.m</b> - write cdata from an image to an ASCII text file, with the positional information.</li>
<li>
<b>gd_write_tiff.m</b> - write the data from an image to a tif file including the position information.</li>
<li>
<b>gd_xy2sn</b> - map grid from cartesian to curvilinear coordinates with option to return the elevations on the source cartesian grid, or as a curvilinear grid.</li>
<li>
<b>gd_sn2xy</b> - map grid from curvilinear to cartesian coordinates.</li>
</ul>
</div>
<h2 id="5">Additional utility functions</h2>
<div>
<ul>
<li>
<b>gd_lineongrid_plot</b> - plots a defined line onto a countour or surface plot of a grid (e.g a channel centre-line).</li>
<li>
<b>gd_user_function</b> - function for user to define bespoke use of grids and grid tools.</li>
</ul>
</div>
<h2 id="6">Functions from Matlab&trade; Exchange Forum</h2>
<div>
<ul>
<li>
<b>a_star</b> - implements the A* search algorithm to find the shortest path given constraints (inaccessible cells) and a cost function (e.g. water depths). Author: Alex Ranaldi, 2022, <a href="https://github.com/alexranaldi/A_STAR">https://github.com/alexranaldi/A_STAR</a>
</li>
<li>
<b>InterX</b> - intersection of two curves. MATLAB Central File Exchange, Author: NS, 2010, <a href="https://www.mathworks.com/matlabcentral/fileexchange/22441-curve-intersections">https://www.mathworks.com/matlabcentral/fileexchange/22441-curve-intersections</a>.</li>
<li>
<b>xy2sn</b> - Bart Vermeulen,2022, Cartesian to Curvilinear coordinate forward and backward transformation. <a href="https://www.mathworks.com/matlabcentral/fileexchange/55039-cartesian-to-curvilinear-coordinate-forward-and-backward-transformation">https://www.mathworks.com/matlabcentral/fileexchange/55039-cartesian-to-curvilinear-coordinate-forward-and-backward-transformation</a>
</li>
<li>
<b>sn2xy</b> - as above.</li>
</ul>
</div>
<p>Further details can be found in <a href="matlab:doc('grid_class_fcns')">Grid classes and functions</a>
</p>
<h2 id="9">Generic functions</h2>
<p>Other functions used in ChannelForm, include:</p>
<div>
<ul>
<li>
<b>cf_plot_centreline</b> - plot 2 or3D line e.g., for valley/channel thalweg.</li>
<li>
<b>get_sed_flux</b> - single element ASMITA model to compute amount of sedimentation.</li>
<li>
<b>lambertw</b> - computes the Lambert W-Function. Author: Pascal Getreuer, Matlab&trade; Exchange Forum.</li>
<li>
<b>river_regime</b> - function to compute the width and hydraulic depth of a river section given the discharge and energy slope.</li>
<li>
<b>sealevelrise.m</b> - function to compute sea level rise using linear or exponential rate of change.</li>
<li>
<b>settling_velocity</b> - calculate the settling velocity using Soulsby equation.</li>
<li>
<b>ucrit</b> - compute the critical flow velocity for a given critical shear stress and wave conditions in the wave-current case.</li>
</ul>
</div>
<h2 id="11">See Also</h2>
<p>The <a href="matlab:doc('channelform_classes')">additional classes</a> used in ChannelForm and the <a href="matlab:cfm_open_manual">manual</a>, which provides further details of setup and configuration of the model.</p>
<p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2024b</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% ChannelForm functions
% Summary of functions available in the _cf_functions_ folder. Use the Matlab(TM)
% help function in the command window to get further details of each
% function.

%% Model functions
% Functions that implement various form models

%%
% * *cf_changeplot* - plot volume difference over the model run and the
% variation of sediment exchange with transgression distance.
% * *cf_cst2grid* - interpolate the CST water levels onto the model grid.
% * *cf_exp_models* - construct idealised channel form using exponential 
% functions in y to determine width and CKFA cross-section to determine 
% z at each x interval.
% * *cf_model_tabs* - generate tabPlot and tabProperties for any
% GDinterface model.
% * *cf_offset_wls* - translate water levels landwards when mouth is some distance from x=0 
% and pad the water level vectors with values at the mouth.
% * *cf_pow_model* - function to compute 3D form of a creek or tidal channel
%   using power laws to define width and hydraulic depth variations.
% * *cf_sectionplot* - plot a set of along-channel cross-sections and the channel centre-line
% (thalweg) for the initial and final grid.
% * *cf_set_hydroprops* - set water levels for form model using either the surface defined by the
% cst_model or high water at the mouth and a reducing tidal amplitude.
% * *cf_summarygridplot* - plot initial grid, new grid and difference.
% * *cf_summarytransplot* - composite set of plots to show 
% results form Transgression table.
% * *cf_valley_model* -  construct idealised channel form using 3D
% exponential form model.
% * *cf_writetable* - write GrossProps and Transgression output tables to a file.
% * *ckfa_3D_form* - construct 3D form of an idealised channel based on the CKFA model.
% * *ckfa_dimensions* - utility to get the CKFA channel form properties:
% hydraulic depth, hm, width convergence length, Lw, critical tidal velocity amplitude, Ucr.
% * *ckfa_form_model* - construct idealised channel form using 3D CKFA model
% * *ckfa_form_solver* - find the hydraulic depth, e-folding length for width and the peak tidal
%   amplitude for defined tidal range and sediment properties.
% * *ckfa_wave_form* - obtain depth and width of wave formed profile at high and low water
% * *ckfa_wave_profile* - depth and width of wave formed profile
% d=dw*(1-y/yw)^2/3.
% * *get_river_profile* - get river profile using regime theoretical
% profile (Cao & Knight,1996).
% * *get_river_regime* - get river regime properties using regime
% theoretical profile (Cao & Knight,1996).

%% Grid Functions
% Functions used to manipulate cartesian grids can be found in the
% _muiAppGridFcns_ folder and include the following:
%% Core grid functions
% * *gd_ax_dir*
% - check direction of grid axes and reverse if descending, OR
% find grid orientation using ishead and direction of x-axis, OR
% check a grid axis direction by prompting user.
% * *gd_centreline.m*
% - create a centreline of a channel using function _a_star_ to trace the
% shortest path between start and end points whilst finding the deepest
% points (i.e. a thalweg).
% * *gd_colormap*
% - check if Mapping toolbox is installed to use land/sea colormap, or call
% _cmap_selection_ if not available (see <matlab:doc('psfunctions') Plotting and statistical functions> 
% in the <matlab:doc('muitoolbox') muitoolbox>).
% * *gd_convergencelength* 
% - least squares fit using fminsearch to % find the convergence length of 
% a channel from a distance-width xy data set.
% * *gd_digitisepoints*
% - creates figure to interactively digitise points on a grid and add
% elevations if required.
% * *gd_dimensions*
% - get the grid dimsnions for a grid struct (as used in GDinterface).
% * *gd_getpoint.m*
% - interactively select a point on a plot and return the point
% coordinates.
% * *gd_grid_line*
% - create a grid from scattered data points input as xyz tuples.
% * *gd_plotgrid*
% - create pcolor plot of gridded surface.
% * *gd_plotsections*
% - display grid and allow user to interactively define start and
% end points of a section line to be plotted in a figure.
% * *gd_pnt2vec.m*
% - convert an array of structs with x,y (and z) fields to a [Nx2] or [Nx3] 
% array of points, or a single stuct with vectors for the x, y (and z)
% fields.
% * *gd_read_image.m*
% - read cdata for an image from an ASCII text file, with the positional
% information.
% * *gd_readshapefile.m*
% - read the x and y coordinates from a shape file. Lines are concatenated
% and separated by NaNs in single x and y vectors. Suitable for reading
% boundaries or sections into a single array.
% * *gd_selectpoints*
% - accept figure to interactively create a specified number of x,y points
% on a grid.
% * *gd_setpoint*
% - interactively select a single point on a plot and return the point
% coordinates. Includes an option to enter an additional value at the
% selected point (e.g. for elevation).
% * *gd_setpoints.m*
% - interactively create a set of points on a plot and return the point
% coordinates. Includes an option to enter an additional value at the
% selected points (e.g. elevation).
% * *gd_startendpoints*
% - accept figure to interactively select start and end points on a grid.
% * *gd_subdomain*
% - accept figure to interactively select a subdomain of a grid.
% * *gd_subgrid*
% - extract a subdomain from a grid and return the extracted
% grid and the source grid indices of the bounding rectangle.
% * *gd_write_image.m*
% - write image to a jpg or tif file.
% * *gd_write_image_ascii.m*
% - write cdata from an image to an ASCII text file, with the positional 
% information.
% * *gd_write_tiff.m*
% - write the data from an image to a tif file including the position
% information.
% * *gd_xy2sn*
% - map grid from cartesian to curvilinear coordinates with option to return 
% the elevations on the source cartesian grid, or as a curvilinear grid.
% * *gd_sn2xy*
% - map grid from curvilinear to cartesian coordinates.

%% Additional utility functions
% * *gd_lineongrid_plot*
% - plots a defined line onto a countour or surface plot of a grid (e.g a
%   channel centre-line).
% * *gd_user_function*
% - function for user to define bespoke use of grids and grid tools.

%% Functions from Matlab(TM) Exchange Forum
%%
% * *a_star*
% - implements the A* search algorithm to find the shortest path given
% constraints (inaccessible cells) and a cost function (e.g. water depths).
% Author: Alex Ranaldi, 2022, https://github.com/alexranaldi/A_STAR
% * *InterX* 
% - intersection of two curves. MATLAB Central File Exchange, 
% Author: NS, 2010, https://www.mathworks.com/matlabcentral/fileexchange/22441-curve-intersections.
% * *xy2sn* 
% - Bart Vermeulen,2022, Cartesian to Curvilinear 
%   coordinate forward and backward transformation. 
%   https://www.mathworks.com/matlabcentral/fileexchange/55039-cartesian-to-curvilinear-coordinate-forward-and-backward-transformation 
% * *sn2xy* 
% - as above.

%%
% Further details can be found in <matlab:doc('grid_class_fcns') Grid classes and functions>
% 
%% Generic functions
% Other functions used in ChannelForm, include:
%%
% * *cf_plot_centreline*
% - plot 2 or3D line e.g., for valley/channel thalweg.
% * *get_sed_flux* - single element ASMITA model to compute amount of
% sedimentation.
% * *lambertw* - computes the Lambert W-Function. Author: Pascal Getreuer,
% Matlab(TM) Exchange Forum.
% * *river_regime* 
% - function to compute the width and hydraulic depth of a river section given the
%   discharge and energy slope.
% * *sealevelrise.m*
% - function to compute sea level rise using linear or exponential rate of
% change.
% * *settling_velocity* - calculate the settling velocity using Soulsby
% equation.
% * *ucrit* -  compute the critical flow velocity for a given critical shear stress and
% wave conditions in the wave-current case.


%% See Also
% The <matlab:doc('channelform_classes') additional classes> used in ChannelForm and
% the <matlab:cfm_open_manual manual>, which provides further details of setup and 
% configuration of the model.

##### SOURCE END #####
-->
</body>
</html>
